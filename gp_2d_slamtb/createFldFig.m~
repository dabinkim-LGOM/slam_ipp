function FldFig = createFldFig(Rob,SimRob,X_test,FigOpt)
% CREATEFLDFIG Visualizes GP field mapping.

FldFig.fig = figure(5);
clf
hold on
set(MapFig.fig,...
    'numbertitle',   'off',...
    'name',          'Field Mapping',...
    'doublebuffer',  'off',...
    'renderer',      FigOpt.renderer,...
    'toolbar',       'none',...
    'color',         FigOpt.map.colors.bckgnd);


% Axes
axis equal
FldFig.axes = gca;
set(FldFig.axes,...
    'parent',              FldFig.fig,...
    'xlim',                [FigOpt.map.lims.xMin FigOpt.map.lims.xMax],...
    'ylim',                [FigOpt.map.lims.yMin FigOpt.map.lims.yMax]);
grid minor;
xlabel('x (m)')
ylabel('y (m)')

% ESTIMATED OBJECTS
% robots
for rob = 1:numel(Rob)
    
    % create and draw robot - with ellipse
    FldFig.Rob(rob).patch = createObjPatch(Rob(rob),FigOpt.map.colors.est,FldFig.axes);
    FldFig.Rob(rob).ellipse = line(...
        'parent', FldFig.axes,...
        'xdata',  [],    ...
        'ydata',  [],    ...
        'zdata',  [],    ...
        'color',  'r',   ...
        'marker', 'none');
    
end


% SIMULATED OBJECTS
if ~isempty(SimRob)
    
    % Robots
    for rob = 1:numel(SimRob)
        
        % create and draw robot
        FldFig.simRob(rob) = createObjPatch(SimRob(rob),FigOpt.map.colors.simu,FldFig.axes);
        
    end
end

% FIELD OBJECT
FldFig.field = scatter(X_test(:,1), X_test(:,2), 100, zeros(size(X_test,1),1), ...
    'filled');
caxis([0 50])
colorbar

end